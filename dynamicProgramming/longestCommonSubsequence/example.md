## C = (AGCAT), R = (GAC)의 LCS구하기

LCS 함수는 0번째 원소를 이용하기 때문에 0번째 **접두사**를 정의하는 것이 편리하다.

> 접두사 - 말단이 잘려나간 수열을 의미


|        | $\Phi$ |   A   |   G   |   C   |   A   |   T   |
| :----: | :----: | :----: | :----: | :----: | :----: | :----: |
| $\Phi$ | $\Phi$ | $\Phi$ | $\Phi$ | $\Phi$ | $\Phi$ | $\Phi$ |
|   G   | $\Phi$ |        |        |        |        |        |
|   A   | $\Phi$ |        |        |        |        |        |
|   C   | $\Phi$ |        |        |        |        |        |

각 연산 단계에서 LCS를 저장하기 위해 사용
$C_0 = \Phi$, $R_0d = \Phi$ 이다.
모든 접두사들은 C를 0행에 위치시키고, R을 0열에 위치시킨 표에 자리잡는다.

> $\Phi$인 부분은 빈 수열을 의미한다.
> 각 표의 1열, 1행이 빈 수열인 이유는 빈 수열이 비어있3지 않은 수열과 비교될 때 가장 긴 공통 부분 수열이 빈 수열이기 때문이다.

$LCS(R_1, C_1)$ - $\Phi$

- 각 수열의 첫 원소를 비교함으로써 결정된다.
- G와 A는 일치하지 않기 때문에 $LCS(R_1, C_0)$과 $LCS(R_0, C_1)$중 긴 것을 갖게 된다.

$LCS(R_1, C_2)$ - G

- 끝자리가 동일(AG, G)하기 때문에 $LCS(R_0, C_1)$G가 된다.

$LCS(R_1, C_3)$ - G

- 끝자리가 일치하지 않는다.(AGC, G)
- $LCS(R_0, C_3)$, $LCS(R_1, C_2)$중 긴 값이 된다.

$LCS(R_1, C_4)$ - G

- 동일 한 방법 사용

$LCS(R_1, C_5)$ - G

- 동일한 방법으로


|        | $\Phi$ |            A            |       G       |        C        |        A        |        T        |
| :----: | :----: | :----------------------: | :-----------: | :-------------: | :-------------: | :-------------: |
| $\Phi$ | $\Phi$ |          $\Phi$          |    $\Phi$    |     $\Phi$     |     $\Phi$     |     $\Phi$     |
|   G   | $\Phi$ | $\leftarrow\uparrow\Phi$ | $\nwarrow(G)$ | $\leftarrow(G)$ | $\leftarrow(G)$ | $\leftarrow(G)$ |
|   A   | $\Phi$ |                          |              |                |                |                |
|   C   | $\Phi$ |                          |              |                |                |                |

> 동일한 방법을 사용하여 답을 구할 수 있다.

최종 완성 LCS 테이블


|        | $\Phi$ |            A            |              G              |              C              |                 A                 |                 T                 |
| :----: | :----: | :----------------------: | :-------------------------: | :-------------------------: | :--------------------------------: | :--------------------------------: |
| $\Phi$ | $\Phi$ |          $\Phi$          |           $\Phi$           |           $\Phi$           |               $\Phi$               |               $\Phi$               |
|   G   | $\Phi$ | $\leftarrow\uparrow\Phi$ |        $\nwarrow(G)$        |       $\leftarrow(G)$       |          $\leftarrow(G)$          |          $\leftarrow(G)$          |
|   A   | $\Phi$ |      $\nwarrow$(A)      | $\leftarrow\uparrow$(A)&(G) | $\leftarrow\uparrow$(A)&(G) |           $\nwarrow$(GA)           |          $\leftarrow$(GA)          |
|   C   | $\Phi$ |      $\uparrow$(A)      | $\leftarrow\uparrow$(A)&(G) |     $\nwarrow$(AC)&(GC)     | $\leftarrow\uparrow$(AC)&(GC)&(GA) | $\leftarrow\uparrow$(AG)&(GC)&(GA) |

> 실제 부분수열들은 표의 마지막 셀로부터 시작하여 화살표들을 거슬러 "역추적"함으로써 추론할 수 있다.
> 길이가 줄어들 때, 각 수열들은 반드시 공통 원소를 가진다. 두 화살표가 한 셀 안에서 있으면 여러 경로가 가능하다.
> 아래는 길이가 감소하는 셀에 대해 색이 칠해진 수들이 나타난 분석 과정을 나타낸 표이다. 굵은 숫자는 (GA) 수열을 찾아내는 경로이다.


|        | $\Phi$ |           A           |             G             |           C           |             A             |             T             |
| :----: |:------:|:---------------------:|:-------------------------:|:---------------------:|:-------------------------:|:-------------------------:|
| $\Phi$ |   0    |         **0**         |             0             |           0           |             0             |             0             |
|   G   | **0**  | $\leftarrow\uparrow$0 |      **$\nwarrow$1**      |   **$\leftarrow$1**   |       $\leftarrow$1       |       $\leftarrow$1       |
|   A   |   0    |    **$\nwarrow$1**    | **$\leftarrow\uparrow$1** | $\leftarrow\uparrow$1 |      **$\nwarrow$2**      |     **$\leftarrow$2**     |
|   C   |   0    |      $\uparrow$1      |   $\leftarrow\uparrow$1   |    **$\nwarrow$2**    | **$\leftarrow\uparrow$2** | **$\leftarrow\uparrow$2** |
