## 최장 공통 부분 수열 문제(LCS, Longest Common Substring)

주어진 여러 개의 수열 모두의 **부분수열**이 되는 수열들 중에 가장 긴 것을 찾는 문제
**Longest Common Substring과는 다른 문제이다.**

> 이 문제는 임의의 수의 수열의 경우에는 NP-난해의 복잡도를 가진다.
> NP-난해, NP-hard는 NP에 속하는 모든 판정 문제를 다항 시간에 다대일 환산할 수 있는 문제들의 집합이다.
> 즉, 적어도 모든 NP문제 만큼은 어려운 문제들의 집합니다.

주어진 수열의 개수가 일정할 경우에는 **동적 계획법**에 의 해 풀린다.
각각의 길이가 $n_1$, ..., $n_n$인 N개의 수열이 주어졌다고 하자.

1. 무식하게 찾는 방법
   - 모든 각 수열의 모든 가능한 부분수열을 전부 하나씩 구해 비교하는 것
   - 이때 각각의 부분수열은 남은 수열의 길이에 선형적으로 비례하는 시간동안 연산된다.
   - $O\left(2^{n_1} \sum_{i>1}n_i \right)$
2. 동적 계획법
   - 두 수열의 n과 m원소에서, 동적 계획법에 의한 실행 시간은 O(n*m)이다.
   - 임의의 입력 수열에 대한 실행시간
   - $\theta\left(N \prod_{k=1}^{N}n_k \right)$

> lcs는 항상 유일해야 하는 것은 아니다.
> 즉 lcs는 종종 최대의 길이를 갖는 모든 공통의 부분수열을 찾아내는 것으로 정의된다.

### 두개의 수열에 대한 해

- LCS는 최적의 부분구조를 가진다. -> 문제가 더 작은, **부분문제**로 쪼개 질 수 있고, 이것은 반복해서 자명한 부분문제가 될 때 까지 쪼개 질 수 있다.

> **최적의 부분구조**와 **겹치는 부분문제**라는 이러한 특성이 동적 프로그래밍이라는 가장 간단한 부분문제에서 출발하는 문제 풀이 기법으로 접근될 수 있다.

> 부분문제의 해답을 저장하는 방식인 **메모이제이션**을 통하여 상위 단계의 부분문제에서 해답을 접근 할 수 있도록 하는 과정을 필요로한다.

> 두 수열 $X_1...m$  and $Y_1...n$이 주어졌을 때, 주어진 두 수열의 최장 공통 부분후열은 다음과 같이 표현된다.

#### 접두사

말단이 잘려나간 수열이다.
접두사는 그 수열의 이름과 그 접두사가 포함되는 문자의 수로 정의된다.

> S를 수열 (AGCA)라 할 경우 접두사는 AG
> 접두사 (AG)는 $S_2$로 명명된다.
> 임의의 두 수열 X, Y에서 LCS문제의 해법, 즉 최장 공통 부분 수열, LCS(X, Y)는 다믕의 두 속성에 의존한다.

##### 속성 1

두 수열이 같은 원소로 끝난다고 가정하자. 그들의 **LCS**를 찾기 위해 마지막 원소를 지움으로써 수열의 길이를 줄이고, 짧아진 수열에 대한 LCS를 찾은 후 삭제한 원소를 붙여준다.

> 예시 BANANA, ATANA
> 마지막 원소가 같으니 삭제, 공통된 마지막 원소가 존재하지 않을 때까지 반복. 삭제된 수열 = ANA
> 남은 수열 = BAN, AT
> 이 남은 수열의 LCS는 (A)
> 삭제했던 부분수열 결합 -> AANA = LCS

$LCS(X_n, Y_m) = (LCS(x_n-1, Y_m-1), X_n)$

> $X_n$과 $Y_n$의 LCS를 계산하려면 $X_n-1$와 $Y_m-1$의 LCS를 계산해야 한다.

##### 속성 2

두 수열 X, Y가 같은 기호로 끝나지 않는 경우 X, Y의 LCS는 $LCS(X_n-1, Y_m)$중 더 긴 수열이다.

> X: ABCDEFG - n개의 원소
> Y: BCDGK - m개의 원소
> 이 두 수열의 LCS의 마지막 문자는 수열 *X의 마지막 원소인 G로 끝나거나, 그렇지 않을 것이다.*

1. LCS가 G로 끝나는 경우
   - 이 경우 LCS는 K료 끝날 수 없다 -> 수열 Y에서 K를 제거해도 손실이 일어나지 않는다.
   - 만약 K가 LCS에 있을 경우 마지막 문자였을 것이기 때문
   - $LCS(X_n, Y_m) = LCS(X_n, Y_{m-1})$
2. LCS가 G로 끝나지 않는 경우
   - *X에서 G를 제거해도 손실이 일어나지 않는다.*
   - $LCS(X_n, Y_m) = LCS(X_{n-1}, Y_m)$
     어떤 경우에서인지 우리가 찾는 LCS는 $LCS(X_{n-1}, Y_m)$ 혹은 $LCS(X_n, Y_{m-1})$이다.
     **이 두 LCS는 둘다 X와 Y의 공통 부분수열 이다.**
     LCS(X, Y)는 최장이다 -> $LCS(X, Y)$ = $LCS(X_{n-1}, Y_m)$, $LCS(X_n, Y_{m-1})$중의 최장 수열이다.
